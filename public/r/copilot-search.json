{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "copilot-search",
  "type": "registry:component",
  "title": "CopilotSearch",
  "description": "Product search with AI-powered filtering and recommendations.",
  "dependencies": [
    "@copilotkit/react-core",
    "lucide-react"
  ],
  "registryDependencies": [
    "badge",
    "input"
  ],
  "files": [
    {
      "path": "registry/copilot-search.tsx",
      "content": "\"use client\";\n\nimport { useState, useMemo, useCallback, useRef } from \"react\";\nimport { useCopilotReadable, useCopilotAction } from \"@copilotkit/react-core\";\nimport { cn } from \"@/lib/utils\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Search,\n  X,\n  Star,\n  Loader2,\n  CheckCircle,\n  Sparkles,\n} from \"lucide-react\";\n\nexport interface Product {\n  id: string;\n  name: string;\n  category: string;\n  price: number;\n  rating: number;\n  description: string;\n  inStock: boolean;\n}\n\ninterface CopilotSearchProps {\n  products?: Product[];\n  className?: string;\n}\n\nconst DEFAULT_PRODUCTS: Product[] = [\n  // Electronics\n  {\n    id: \"e1\",\n    name: \"Wireless Headphones\",\n    category: \"Electronics\",\n    price: 79,\n    rating: 4.5,\n    description:\n      \"Premium over-ear headphones with active noise cancellation and 30-hour battery life.\",\n    inStock: true,\n  },\n  {\n    id: \"e2\",\n    name: \"Smart Watch\",\n    category: \"Electronics\",\n    price: 199,\n    rating: 4.2,\n    description:\n      \"Fitness-focused smartwatch with heart rate monitoring, GPS, and a vibrant AMOLED display.\",\n    inStock: true,\n  },\n  {\n    id: \"e3\",\n    name: \"Bluetooth Speaker\",\n    category: \"Electronics\",\n    price: 49,\n    rating: 4.7,\n    description:\n      \"Portable waterproof speaker with 360-degree sound and 12-hour playtime.\",\n    inStock: true,\n  },\n  {\n    id: \"e4\",\n    name: \"USB-C Hub\",\n    category: \"Electronics\",\n    price: 35,\n    rating: 4.0,\n    description:\n      \"7-in-1 USB-C hub with HDMI, USB 3.0 ports, SD card reader, and power delivery.\",\n    inStock: false,\n  },\n  // Books\n  {\n    id: \"b1\",\n    name: \"Clean Code\",\n    category: \"Books\",\n    price: 42,\n    rating: 4.8,\n    description:\n      \"A handbook of agile software craftsmanship by Robert C. Martin, essential for every developer.\",\n    inStock: true,\n  },\n  {\n    id: \"b2\",\n    name: \"Design Patterns\",\n    category: \"Books\",\n    price: 55,\n    rating: 4.6,\n    description:\n      \"The classic Gang of Four guide to reusable object-oriented software design patterns.\",\n    inStock: true,\n  },\n  {\n    id: \"b3\",\n    name: \"The Pragmatic Programmer\",\n    category: \"Books\",\n    price: 45,\n    rating: 4.9,\n    description:\n      \"Timeless advice on becoming a better programmer, from journeyman to master craftsman.\",\n    inStock: true,\n  },\n  {\n    id: \"b4\",\n    name: \"Refactoring\",\n    category: \"Books\",\n    price: 48,\n    rating: 4.4,\n    description:\n      \"Martin Fowler's definitive guide to improving the design of existing code safely.\",\n    inStock: false,\n  },\n  // Clothing\n  {\n    id: \"c1\",\n    name: \"Tech Hoodie\",\n    category: \"Clothing\",\n    price: 65,\n    rating: 4.3,\n    description:\n      \"Soft fleece hoodie with hidden cable routing and a zippered phone pocket.\",\n    inStock: true,\n  },\n  {\n    id: \"c2\",\n    name: \"Running Shoes\",\n    category: \"Clothing\",\n    price: 120,\n    rating: 4.6,\n    description:\n      \"Lightweight breathable running shoes with responsive cushioning for daily training.\",\n    inStock: true,\n  },\n  {\n    id: \"c3\",\n    name: \"Casual Backpack\",\n    category: \"Clothing\",\n    price: 85,\n    rating: 4.5,\n    description:\n      \"Water-resistant laptop backpack with ergonomic straps and multiple compartments.\",\n    inStock: true,\n  },\n  {\n    id: \"c4\",\n    name: \"Wool Beanie\",\n    category: \"Clothing\",\n    price: 25,\n    rating: 4.1,\n    description:\n      \"Cozy merino wool beanie that keeps you warm without overheating.\",\n    inStock: false,\n  },\n  // Home\n  {\n    id: \"h1\",\n    name: \"Desk Lamp\",\n    category: \"Home\",\n    price: 38,\n    rating: 4.4,\n    description:\n      \"Adjustable LED desk lamp with multiple brightness levels and a warm-to-cool color range.\",\n    inStock: true,\n  },\n  {\n    id: \"h2\",\n    name: \"Standing Desk Mat\",\n    category: \"Home\",\n    price: 45,\n    rating: 4.2,\n    description:\n      \"Anti-fatigue standing desk mat with cushioned support for long work sessions.\",\n    inStock: true,\n  },\n  {\n    id: \"h3\",\n    name: \"Mechanical Keyboard\",\n    category: \"Home\",\n    price: 149,\n    rating: 4.8,\n    description:\n      \"Hot-swappable mechanical keyboard with RGB backlighting and a satisfying tactile feel.\",\n    inStock: true,\n  },\n  {\n    id: \"h4\",\n    name: \"Monitor Light Bar\",\n    category: \"Home\",\n    price: 55,\n    rating: 4.6,\n    description:\n      \"Screen-mounted light bar that reduces eye strain with asymmetric lighting design.\",\n    inStock: true,\n  },\n];\n\ntype SortField = \"price\" | \"rating\" | \"name\";\ntype SortDirection = \"asc\" | \"desc\";\n\ninterface SortOrder {\n  field: SortField;\n  direction: SortDirection;\n}\n\nfunction StarRating({ rating }: { rating: number }) {\n  return (\n    <div className=\"flex items-center gap-0.5\">\n      {Array.from({ length: 5 }, (_, i) => {\n        const filled = i < Math.round(rating);\n        return (\n          <Star\n            key={i}\n            className={cn(\n              \"h-3.5 w-3.5\",\n              filled\n                ? \"fill-amber-400 text-amber-400\"\n                : \"text-muted-foreground/30\"\n            )}\n          />\n        );\n      })}\n      <span className=\"ml-1 text-xs text-muted-foreground\">{rating}</span>\n    </div>\n  );\n}\n\nexport function CopilotSearch({\n  products = DEFAULT_PRODUCTS,\n  className,\n}: CopilotSearchProps) {\n  const [query, setQuery] = useState(\"\");\n  const [filters, setFilters] = useState<string[]>([]);\n  const [sortOrder, setSortOrder] = useState<SortOrder | null>(null);\n  const [highlightedId, setHighlightedId] = useState<string | null>(null);\n  const highlightTimeout = useRef<NodeJS.Timeout | null>(null);\n\n  const filteredResults = useMemo(() => {\n    let result = [...products];\n\n    // Apply text search\n    if (query.trim()) {\n      const q = query.toLowerCase();\n      result = result.filter(\n        (p) =>\n          p.name.toLowerCase().includes(q) ||\n          p.category.toLowerCase().includes(q) ||\n          p.description.toLowerCase().includes(q)\n      );\n    }\n\n    // Apply category filters\n    if (filters.length > 0) {\n      result = result.filter((p) =>\n        filters.some(\n          (f) =>\n            p.category.toLowerCase() === f.toLowerCase() ||\n            p.name.toLowerCase().includes(f.toLowerCase())\n        )\n      );\n    }\n\n    // Apply sort\n    if (sortOrder) {\n      result.sort((a, b) => {\n        let cmp = 0;\n        if (sortOrder.field === \"price\") {\n          cmp = a.price - b.price;\n        } else if (sortOrder.field === \"rating\") {\n          cmp = a.rating - b.rating;\n        } else {\n          cmp = a.name.localeCompare(b.name);\n        }\n        return sortOrder.direction === \"asc\" ? cmp : -cmp;\n      });\n    }\n\n    return result;\n  }, [products, query, filters, sortOrder]);\n\n  const triggerHighlight = useCallback((productId: string) => {\n    setHighlightedId(productId);\n    if (highlightTimeout.current) {\n      clearTimeout(highlightTimeout.current);\n    }\n    highlightTimeout.current = setTimeout(() => {\n      setHighlightedId(null);\n    }, 1500);\n  }, []);\n\n  // Expose search state to AI\n  useCopilotReadable({\n    description:\n      \"Current search interface state including results, active filters, and sort order\",\n    value: {\n      query,\n      totalProducts: products.length,\n      visibleResults: filteredResults.length,\n      activeFilters: filters,\n      sortOrder,\n      results: filteredResults.map((p) => ({\n        id: p.id,\n        name: p.name,\n        category: p.category,\n        price: p.price,\n        rating: p.rating,\n        inStock: p.inStock,\n      })),\n      availableCategories: [\n        ...new Set(products.map((p) => p.category)),\n      ],\n    },\n  });\n\n  // AI action: search products\n  useCopilotAction({\n    name: \"search\",\n    description:\n      \"Search for products by name, category, or description. Sets the search query text.\",\n    parameters: [\n      {\n        name: \"query\",\n        type: \"string\",\n        description: \"The search query to filter products\",\n        required: true,\n      },\n    ],\n    render: ({ status, args }) => {\n      if (status === \"inProgress\") {\n        return (\n          <div className=\"flex items-center gap-2 rounded-lg border border-border/50 bg-card/50 px-3 py-2 text-sm\">\n            <Loader2 className=\"h-4 w-4 animate-spin text-violet-400\" />\n            <span>Searching...</span>\n          </div>\n        );\n      }\n      return (\n        <div className=\"flex items-center gap-2 rounded-lg border border-violet-500/30 bg-violet-500/10 px-3 py-2 text-sm text-violet-400\">\n          <CheckCircle className=\"h-4 w-4\" />\n          <span>\n            Searched for <strong>&quot;{args.query}&quot;</strong>\n          </span>\n        </div>\n      );\n    },\n    handler: ({ query: searchQuery }) => {\n      setQuery(searchQuery);\n      return `Search updated to \"${searchQuery}\"`;\n    },\n  });\n\n  // AI action: add filter\n  useCopilotAction({\n    name: \"addFilter\",\n    description:\n      \"Add a filter chip to narrow down results by category or keyword. Available categories: Electronics, Books, Clothing, Home.\",\n    parameters: [\n      {\n        name: \"filter\",\n        type: \"string\",\n        description: \"The filter value to add (e.g., a category name)\",\n        required: true,\n      },\n    ],\n    render: ({ status, args }) => {\n      if (status === \"inProgress\") {\n        return (\n          <div className=\"flex items-center gap-2 rounded-lg border border-border/50 bg-card/50 px-3 py-2 text-sm\">\n            <Loader2 className=\"h-4 w-4 animate-spin text-emerald-400\" />\n            <span>Adding filter...</span>\n          </div>\n        );\n      }\n      return (\n        <div className=\"flex items-center gap-2 rounded-lg border border-emerald-500/30 bg-emerald-500/10 px-3 py-2 text-sm text-emerald-400\">\n          <CheckCircle className=\"h-4 w-4\" />\n          <span>\n            Added filter <strong>&quot;{args.filter}&quot;</strong>\n          </span>\n        </div>\n      );\n    },\n    handler: ({ filter }) => {\n      setFilters((prev) => {\n        if (prev.some((f) => f.toLowerCase() === filter.toLowerCase())) {\n          return prev;\n        }\n        return [...prev, filter];\n      });\n      return `Filter \"${filter}\" added`;\n    },\n  });\n\n  // AI action: remove filter\n  useCopilotAction({\n    name: \"removeFilter\",\n    description: \"Remove an active filter chip from the search results\",\n    parameters: [\n      {\n        name: \"filter\",\n        type: \"string\",\n        description: \"The filter value to remove\",\n        required: true,\n      },\n    ],\n    render: ({ status, args }) => {\n      if (status === \"inProgress\") {\n        return (\n          <div className=\"flex items-center gap-2 rounded-lg border border-border/50 bg-card/50 px-3 py-2 text-sm\">\n            <Loader2 className=\"h-4 w-4 animate-spin text-rose-400\" />\n            <span>Removing filter...</span>\n          </div>\n        );\n      }\n      return (\n        <div className=\"flex items-center gap-2 rounded-lg border border-rose-500/30 bg-rose-500/10 px-3 py-2 text-sm text-rose-400\">\n          <CheckCircle className=\"h-4 w-4\" />\n          <span>\n            Removed filter <strong>&quot;{args.filter}&quot;</strong>\n          </span>\n        </div>\n      );\n    },\n    handler: ({ filter }) => {\n      setFilters((prev) =>\n        prev.filter((f) => f.toLowerCase() !== filter.toLowerCase())\n      );\n      return `Filter \"${filter}\" removed`;\n    },\n  });\n\n  // AI action: sort results\n  useCopilotAction({\n    name: \"sortResults\",\n    description:\n      \"Sort search results by a specific field in ascending or descending order\",\n    parameters: [\n      {\n        name: \"field\",\n        type: \"string\",\n        description:\n          \"The field to sort by: 'price', 'rating', or 'name'\",\n        required: true,\n      },\n      {\n        name: \"direction\",\n        type: \"string\",\n        description: \"Sort direction: 'asc' for ascending or 'desc' for descending\",\n        required: true,\n      },\n    ],\n    render: ({ status, args }) => {\n      if (status === \"inProgress\") {\n        return (\n          <div className=\"flex items-center gap-2 rounded-lg border border-border/50 bg-card/50 px-3 py-2 text-sm\">\n            <Loader2 className=\"h-4 w-4 animate-spin text-blue-400\" />\n            <span>Sorting results...</span>\n          </div>\n        );\n      }\n      return (\n        <div className=\"flex items-center gap-2 rounded-lg border border-blue-500/30 bg-blue-500/10 px-3 py-2 text-sm text-blue-400\">\n          <CheckCircle className=\"h-4 w-4\" />\n          <span>\n            Sorted by <strong>{args.field}</strong>{\" \"}\n            {args.direction === \"asc\" ? \"ascending\" : \"descending\"}\n          </span>\n        </div>\n      );\n    },\n    handler: ({ field, direction }) => {\n      const validFields: SortField[] = [\"price\", \"rating\", \"name\"];\n      if (!validFields.includes(field as SortField)) {\n        return `Invalid sort field \"${field}\". Use price, rating, or name.`;\n      }\n      setSortOrder({\n        field: field as SortField,\n        direction: direction as SortDirection,\n      });\n      return `Results sorted by ${field} ${direction}ending`;\n    },\n  });\n\n  // AI action: highlight result\n  useCopilotAction({\n    name: \"highlightResult\",\n    description:\n      \"Highlight a specific product result to draw attention to it. The highlight will glow briefly.\",\n    parameters: [\n      {\n        name: \"productId\",\n        type: \"string\",\n        description:\n          \"The product ID to highlight (e.g., 'e1', 'b2', 'c3', 'h4')\",\n        required: true,\n      },\n    ],\n    render: ({ status, args }) => {\n      if (status === \"inProgress\") {\n        return (\n          <div className=\"flex items-center gap-2 rounded-lg border border-border/50 bg-card/50 px-3 py-2 text-sm\">\n            <Loader2 className=\"h-4 w-4 animate-spin text-amber-400\" />\n            <span>Highlighting result...</span>\n          </div>\n        );\n      }\n      return (\n        <div className=\"flex items-center gap-2 rounded-lg border border-amber-500/30 bg-amber-500/10 px-3 py-2 text-sm text-amber-400\">\n          <CheckCircle className=\"h-4 w-4\" />\n          <span>\n            Highlighted product <strong>{args.productId}</strong>\n          </span>\n        </div>\n      );\n    },\n    handler: ({ productId }) => {\n      const product = products.find((p) => p.id === productId);\n      if (!product) return `Product with ID \"${productId}\" not found`;\n      triggerHighlight(productId);\n      return `Highlighted \"${product.name}\"`;\n    },\n  });\n\n  const removeFilter = (filter: string) => {\n    setFilters((prev) => prev.filter((f) => f !== filter));\n  };\n\n  return (\n    <div className={cn(\"w-full space-y-4\", className)}>\n      {/* Search bar */}\n      <div className=\"relative\">\n        <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n        <Input\n          type=\"text\"\n          placeholder=\"Search products...\"\n          value={query}\n          onChange={(e) => setQuery(e.target.value)}\n          className=\"pl-10\"\n        />\n      </div>\n\n      {/* Active filter chips */}\n      {filters.length > 0 && (\n        <div className=\"flex flex-wrap items-center gap-2\">\n          {filters.map((filter) => (\n            <Badge\n              key={filter}\n              variant=\"secondary\"\n              className=\"gap-1.5 bg-violet-500/10 text-violet-400 border border-violet-500/30 pr-1.5\"\n            >\n              {filter}\n              <button\n                onClick={() => removeFilter(filter)}\n                className=\"ml-0.5 rounded-full p-0.5 hover:bg-violet-500/20 transition-colors\"\n              >\n                <X className=\"h-3 w-3\" />\n              </button>\n            </Badge>\n          ))}\n          <button\n            onClick={() => {\n              setFilters([]);\n              setSortOrder(null);\n              setQuery(\"\");\n            }}\n            className=\"text-xs text-muted-foreground hover:text-foreground transition-colors\"\n          >\n            Clear all\n          </button>\n        </div>\n      )}\n\n      {/* Result count */}\n      <div className=\"flex items-center justify-between text-sm text-muted-foreground\">\n        <span>\n          Showing {filteredResults.length} of {products.length} products\n        </span>\n        {sortOrder && (\n          <span className=\"flex items-center gap-1 text-xs\">\n            <Sparkles className=\"h-3 w-3 text-blue-400\" />\n            Sorted by {sortOrder.field}{\" \"}\n            {sortOrder.direction === \"asc\" ? \"ascending\" : \"descending\"}\n          </span>\n        )}\n      </div>\n\n      {/* Results grid */}\n      {filteredResults.length === 0 ? (\n        <div className=\"flex flex-col items-center justify-center rounded-lg border border-border/50 py-12 text-muted-foreground\">\n          <Search className=\"mb-3 h-8 w-8 text-muted-foreground/40\" />\n          <p className=\"text-sm\">No products found.</p>\n          <p className=\"text-xs text-muted-foreground/60\">\n            Try adjusting your search or filters.\n          </p>\n        </div>\n      ) : (\n        <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2\">\n          {filteredResults.map((product) => {\n            const isHighlighted = highlightedId === product.id;\n            return (\n              <div\n                key={product.id}\n                className={cn(\n                  \"rounded-lg border border-border/50 bg-card/50 p-4 transition-all duration-300\",\n                  isHighlighted &&\n                    \"border-violet-500/60 shadow-[0_0_0_1px_rgba(139,92,246,0.3),0_0_16px_rgba(139,92,246,0.25)] animate-[highlight-glow_1.5s_ease-in-out]\",\n                  !isHighlighted && \"hover:border-border hover:bg-card/80\"\n                )}\n              >\n                {/* Header: name and category */}\n                <div className=\"flex items-start justify-between gap-2\">\n                  <h3 className=\"font-medium text-foreground\">\n                    {product.name}\n                  </h3>\n                  <Badge\n                    variant=\"secondary\"\n                    className=\"shrink-0 text-[10px] px-2 py-0.5\"\n                  >\n                    {product.category}\n                  </Badge>\n                </div>\n\n                {/* Price and rating */}\n                <div className=\"mt-2 flex items-center justify-between\">\n                  <span className=\"text-lg font-semibold text-foreground\">\n                    ${product.price}\n                  </span>\n                  <StarRating rating={product.rating} />\n                </div>\n\n                {/* Description */}\n                <p className=\"mt-2 text-xs leading-relaxed text-muted-foreground\">\n                  {product.description}\n                </p>\n\n                {/* Stock indicator */}\n                <div className=\"mt-3 flex items-center gap-1.5\">\n                  <span\n                    className={cn(\n                      \"h-2 w-2 rounded-full\",\n                      product.inStock ? \"bg-emerald-400\" : \"bg-red-400\"\n                    )}\n                  />\n                  <span\n                    className={cn(\n                      \"text-xs\",\n                      product.inStock\n                        ? \"text-emerald-400\"\n                        : \"text-red-400\"\n                    )}\n                  >\n                    {product.inStock ? \"In Stock\" : \"Out of Stock\"}\n                  </span>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n}\n",
      "type": "registry:component"
    }
  ]
}