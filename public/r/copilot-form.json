{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "copilot-form",
  "type": "registry:component",
  "title": "CopilotForm",
  "description": "An intent-driven form â€” describe what you want and it fills itself.",
  "dependencies": [
    "@copilotkit/react-core",
    "lucide-react"
  ],
  "registryDependencies": [
    "badge",
    "button",
    "input"
  ],
  "docs": "## Setup\n\n### 1. Install CopilotKit dependencies\n\n```bash\nnpm install @copilotkit/react-core @copilotkit/react-ui @copilotkit/runtime\n```\n\n### 2. Create an API route\n\nCreate `app/api/copilotkit/route.ts`:\n\n```ts\nimport {\n  CopilotRuntime,\n  OpenAIAdapter,\n  copilotRuntimeNextJSAppRouterEndpoint,\n} from \"@copilotkit/runtime\";\n\nexport const maxDuration = 60;\n\nconst runtime = new CopilotRuntime();\nconst serviceAdapter = new OpenAIAdapter();\n\nconst { handleRequest } = copilotRuntimeNextJSAppRouterEndpoint({\n  runtime,\n  serviceAdapter,\n  endpoint: \"/api/copilotkit\",\n});\n\nexport { handleRequest as POST };\n```\n\n### 3. Environment variables\n\nAdd to `.env.local`:\n\n```\nOPENAI_API_KEY=sk-...\n```\n\n### 4. Wrap your app with CopilotKit\n\nIn your page or layout, wrap the component tree with the CopilotKit provider and add a chat UI:\n\n```tsx\n\"use client\";\nimport { CopilotKit } from \"@copilotkit/react-core\";\nimport { CopilotPopup } from \"@copilotkit/react-ui\";\nimport \"@copilotkit/react-ui/styles.css\";\n\nexport default function Page() {\n  return (\n    <CopilotKit runtimeUrl=\"/api/copilotkit\">\n      {/* your components here */}\n      <CopilotPopup />\n    </CopilotKit>\n  );\n}\n```\n\n## Usage\n\n```tsx\nimport { CopilotForm, FieldConfig } from \"@/components/copilot-form\";\n\nconst fields: FieldConfig[] = [\n  { name: \"name\", label: \"Full Name\", type: \"text\", required: true },\n  { name: \"email\", label: \"Email\", type: \"text\", required: true },\n  {\n    name: \"role\",\n    label: \"Role\",\n    type: \"select\",\n    options: [\"Engineer\", \"Designer\", \"PM\"],\n  },\n  { name: \"bio\", label: \"Bio\", type: \"textarea\" },\n];\n\n<CopilotForm\n  fields={fields}\n  onSubmit={(values) => console.log(values)}\n/>\n```\n\nTell the AI something like \"fill this out for a senior engineer named Jane\" and it will populate the fields.",
  "files": [
    {
      "path": "registry/copilot-form.tsx",
      "content": "\"use client\";\n\nimport { useState, useCallback, useRef } from \"react\";\nimport { useCopilotReadable, useCopilotAction } from \"@copilotkit/react-core\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { cn } from \"@/lib/utils\";\nimport { Sparkles, CheckCircle, Loader2 } from \"lucide-react\";\n\nexport interface FieldConfig {\n  name: string;\n  label: string;\n  type: \"text\" | \"select\" | \"textarea\";\n  options?: string[];\n  placeholder?: string;\n  required?: boolean;\n}\n\ninterface CopilotFormProps {\n  fields: FieldConfig[];\n  onSubmit: (values: Record<string, string>) => void;\n  className?: string;\n}\n\nexport function CopilotForm({ fields, onSubmit, className }: CopilotFormProps) {\n  const [values, setValues] = useState<Record<string, string>>(() =>\n    Object.fromEntries(fields.map((f) => [f.name, \"\"]))\n  );\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [aiFilledFields, setAiFilledFields] = useState<Set<string>>(new Set());\n  const [highlightedFields, setHighlightedFields] = useState<Set<string>>(\n    new Set()\n  );\n  const timeoutRefs = useRef<Record<string, NodeJS.Timeout>>({});\n\n  const triggerHighlight = useCallback((fieldName: string) => {\n    setHighlightedFields((prev) => new Set(prev).add(fieldName));\n    if (timeoutRefs.current[fieldName]) {\n      clearTimeout(timeoutRefs.current[fieldName]);\n    }\n    timeoutRefs.current[fieldName] = setTimeout(() => {\n      setHighlightedFields((prev) => {\n        const next = new Set(prev);\n        next.delete(fieldName);\n        return next;\n      });\n    }, 1500);\n  }, []);\n\n  const setFieldValue = useCallback(\n    (fieldName: string, value: string) => {\n      setValues((prev) => ({ ...prev, [fieldName]: value }));\n      setAiFilledFields((prev) => new Set(prev).add(fieldName));\n      triggerHighlight(fieldName);\n    },\n    [triggerHighlight]\n  );\n\n  useCopilotReadable({\n    description: \"Current form field definitions and their values\",\n    value: {\n      fields: fields.map((f) => ({\n        name: f.name,\n        label: f.label,\n        type: f.type,\n        options: f.options,\n        currentValue: values[f.name] || \"\",\n      })),\n    },\n  });\n\n  useCopilotAction({\n    name: \"fillForm\",\n    description:\n      \"Fill multiple form fields at once. Use this when the user describes what values to set.\",\n    parameters: [\n      {\n        name: \"fields\",\n        type: \"object[]\",\n        description: \"Array of field name and value pairs to fill\",\n        attributes: [\n          {\n            name: \"fieldName\",\n            type: \"string\",\n            description: \"The name of the field to fill\",\n          },\n          {\n            name: \"value\",\n            type: \"string\",\n            description: \"The value to set for the field\",\n          },\n        ],\n      },\n    ],\n    render: ({ status, args }) => {\n      if (status === \"inProgress\") {\n        return (\n          <div className=\"flex items-center gap-2 rounded-lg border border-border/50 bg-card/50 px-3 py-2 text-sm\">\n            <Loader2 className=\"h-4 w-4 animate-spin text-emerald-400\" />\n            <span>Filling form...</span>\n          </div>\n        );\n      }\n      const filledFields = args.fields ?? [];\n      return (\n        <div className=\"rounded-lg border border-emerald-500/30 bg-emerald-500/10 px-3 py-2 text-sm text-emerald-400\">\n          <div className=\"mb-1 font-medium\">Form updated</div>\n          <ul className=\"space-y-0.5\">\n            {filledFields.map((f: { fieldName?: string; value?: string }, i: number) => (\n              <li key={i} className=\"flex items-center gap-1.5 text-xs\">\n                <CheckCircle className=\"h-3 w-3 shrink-0\" />\n                <span className=\"text-emerald-300\">{f.fieldName}</span>\n                <span className=\"text-emerald-400/60\">&rarr;</span>\n                <span className=\"truncate\">{f.value}</span>\n              </li>\n            ))}\n          </ul>\n        </div>\n      );\n    },\n    handler: ({ fields: fieldUpdates }) => {\n      for (const { fieldName, value } of fieldUpdates) {\n        if (fieldName in values) {\n          setFieldValue(fieldName, value);\n        }\n      }\n    },\n  });\n\n  useCopilotAction({\n    name: \"clearForm\",\n    description: \"Reset all form fields to empty values\",\n    parameters: [],\n    handler: () => {\n      setValues(Object.fromEntries(fields.map((f) => [f.name, \"\"])));\n      setAiFilledFields(new Set());\n    },\n  });\n\n  useCopilotAction({\n    name: \"suggestValues\",\n    description:\n      \"Suggest a value for a specific empty field based on context\",\n    parameters: [\n      {\n        name: \"fieldName\",\n        type: \"string\",\n        description: \"The name of the field to suggest a value for\",\n      },\n      {\n        name: \"suggestion\",\n        type: \"string\",\n        description: \"The suggested value\",\n      },\n    ],\n    handler: ({ fieldName, suggestion }) => {\n      if (fieldName in values) {\n        setFieldValue(fieldName, suggestion);\n      }\n    },\n  });\n\n  const handleChange = (fieldName: string, value: string) => {\n    setValues((prev) => ({ ...prev, [fieldName]: value }));\n    setAiFilledFields((prev) => {\n      const next = new Set(prev);\n      next.delete(fieldName);\n      return next;\n    });\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    const newErrors: Record<string, string> = {};\n    for (const field of fields) {\n      if (field.required && !values[field.name]?.trim()) {\n        newErrors[field.name] = `${field.label} is required`;\n      }\n    }\n    if (Object.keys(newErrors).length > 0) {\n      setErrors(newErrors);\n      return;\n    }\n    setErrors({});\n    onSubmit(values);\n  };\n\n  return (\n    <form onSubmit={handleSubmit} role=\"form\" aria-label=\"Form\" className={cn(\"space-y-4\", className)}>\n      {fields.map((field) => (\n        <div key={field.name} className=\"space-y-1.5\">\n          <div className=\"flex items-center gap-2\">\n            <label\n              htmlFor={field.name}\n              className=\"text-sm font-medium text-foreground\"\n            >\n              {field.label}{field.required && <span className=\"text-destructive ml-0.5\">*</span>}\n            </label>\n            {aiFilledFields.has(field.name) && (\n              <Badge\n                variant=\"secondary\"\n                className=\"gap-1 bg-emerald-500/10 text-emerald-400 text-[10px] px-1.5 py-0\"\n              >\n                <Sparkles className=\"size-2.5\" />\n                AI filled\n              </Badge>\n            )}\n          </div>\n\n          <div\n            className={cn(\n              \"rounded-md transition-shadow duration-700\",\n              highlightedFields.has(field.name) &&\n                \"shadow-[0_0_0_2px_rgba(16,185,129,0.4),0_0_12px_rgba(16,185,129,0.2)]\"\n            )}\n          >\n            {field.type === \"select\" ? (\n              <select\n                id={field.name}\n                value={values[field.name]}\n                onChange={(e) => handleChange(field.name, e.target.value)}\n                aria-invalid={!!errors[field.name]}\n                className=\"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-xs transition-colors focus-visible:outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] dark:bg-input/30 text-foreground\"\n              >\n                <option value=\"\" className=\"bg-background text-muted-foreground\">\n                  {field.placeholder || `Select ${field.label.toLowerCase()}`}\n                </option>\n                {field.options?.map((opt) => (\n                  <option key={opt} value={opt} className=\"bg-background text-foreground\">\n                    {opt}\n                  </option>\n                ))}\n              </select>\n            ) : field.type === \"textarea\" ? (\n              <textarea\n                id={field.name}\n                value={values[field.name]}\n                onChange={(e) => handleChange(field.name, e.target.value)}\n                placeholder={field.placeholder}\n                aria-invalid={!!errors[field.name]}\n                rows={3}\n                className=\"flex min-h-[72px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-xs transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] dark:bg-input/30\"\n              />\n            ) : (\n              <Input\n                id={field.name}\n                value={values[field.name]}\n                onChange={(e) => handleChange(field.name, e.target.value)}\n                placeholder={field.placeholder}\n                aria-invalid={!!errors[field.name]}\n              />\n            )}\n          </div>\n          {errors[field.name] && (\n            <p className=\"text-xs text-destructive mt-1\">{errors[field.name]}</p>\n          )}\n        </div>\n      ))}\n\n      <Button type=\"submit\" className=\"w-full mt-2\">\n        Submit\n      </Button>\n    </form>\n  );\n}\n",
      "type": "registry:component"
    }
  ]
}