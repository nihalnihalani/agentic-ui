{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "copilot-chat",
  "type": "registry:component",
  "title": "CopilotChat",
  "description": "Chat interface with AI message management and conversation history.",
  "dependencies": [
    "@copilotkit/react-core",
    "lucide-react"
  ],
  "registryDependencies": [
    "button",
    "input"
  ],
  "files": [
    {
      "path": "registry/copilot-chat.tsx",
      "content": "\"use client\";\n\nimport { useState, useRef, useEffect, useCallback } from \"react\";\nimport { useCopilotReadable, useCopilotAction } from \"@copilotkit/react-core\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { cn } from \"@/lib/utils\";\nimport {\n  Send,\n  Trash2,\n  Search,\n  FileText,\n  Loader2,\n  MessageSquare,\n} from \"lucide-react\";\n\nexport interface ChatMessage {\n  id: string;\n  sender: string;\n  content: string;\n  timestamp: string;\n  isHighlighted?: boolean;\n}\n\ninterface CopilotChatProps {\n  initialMessages?: ChatMessage[];\n  className?: string;\n}\n\nconst defaultMessages: ChatMessage[] = [\n  {\n    id: \"msg-1\",\n    sender: \"You\",\n    content:\n      \"Hey Alex, how's everything looking for the project launch next week?\",\n    timestamp: \"10:02 AM\",\n  },\n  {\n    id: \"msg-2\",\n    sender: \"Alex\",\n    content:\n      \"Pretty good! The design assets are finalized and the dev team merged the last feature branch yesterday.\",\n    timestamp: \"10:04 AM\",\n  },\n  {\n    id: \"msg-3\",\n    sender: \"You\",\n    content:\n      \"Nice. Did QA finish the regression tests yet?\",\n    timestamp: \"10:05 AM\",\n  },\n  {\n    id: \"msg-4\",\n    sender: \"Alex\",\n    content:\n      \"Almost \\u2014 they found two minor bugs in the checkout flow. Fixes are in review right now, should be merged by EOD.\",\n    timestamp: \"10:07 AM\",\n  },\n  {\n    id: \"msg-5\",\n    sender: \"You\",\n    content:\n      \"Great. Let's sync tomorrow morning to go over the launch checklist one more time.\",\n    timestamp: \"10:09 AM\",\n  },\n  {\n    id: \"msg-6\",\n    sender: \"Alex\",\n    content:\n      \"Sounds good! I'll prepare the final deployment runbook and share it before the meeting.\",\n    timestamp: \"10:11 AM\",\n  },\n];\n\nexport function CopilotChat({ initialMessages, className }: CopilotChatProps) {\n  const [messages, setMessages] = useState<ChatMessage[]>(\n    initialMessages ?? defaultMessages\n  );\n  const [inputValue, setInputValue] = useState(\"\");\n  const [isTyping, setIsTyping] = useState(false);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n\n  // Auto-scroll to bottom when messages change or typing indicator appears\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [messages, isTyping]);\n\n  const addMessage = useCallback(\n    (sender: string, content: string) => {\n      const now = new Date();\n      const hours = now.getHours();\n      const minutes = now.getMinutes().toString().padStart(2, \"0\");\n      const ampm = hours >= 12 ? \"PM\" : \"AM\";\n      const displayHours = hours % 12 || 12;\n      const timestamp = `${displayHours}:${minutes} ${ampm}`;\n\n      const newMessage: ChatMessage = {\n        id: `msg-${Date.now()}-${Math.random().toString(36).slice(2, 7)}`,\n        sender,\n        content,\n        timestamp,\n      };\n      setMessages((prev) => [...prev, newMessage]);\n      return newMessage;\n    },\n    []\n  );\n\n  const handleSend = () => {\n    const text = inputValue.trim();\n    if (!text) return;\n    addMessage(\"You\", text);\n    setInputValue(\"\");\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      handleSend();\n    }\n  };\n\n  // Expose message history to AI\n  useCopilotReadable({\n    description:\n      \"The current chat message history including sender names, message content, and timestamps\",\n    value: {\n      totalMessages: messages.length,\n      messages: messages.map((m) => ({\n        id: m.id,\n        sender: m.sender,\n        content: m.content,\n        timestamp: m.timestamp,\n        isHighlighted: m.isHighlighted ?? false,\n      })),\n    },\n  });\n\n  // Action: Send a message on behalf of a participant\n  useCopilotAction({\n    name: \"sendMessage\",\n    description:\n      \"Send a new chat message. Use sender 'You' for the user or another name like 'Alex' for other participants.\",\n    parameters: [\n      {\n        name: \"sender\",\n        type: \"string\",\n        description: \"The name of the message sender (e.g. 'You' or 'Alex')\",\n        required: true,\n      },\n      {\n        name: \"content\",\n        type: \"string\",\n        description: \"The message text to send\",\n        required: true,\n      },\n    ],\n    render: ({ status, args }) => {\n      if (status === \"inProgress\") {\n        return (\n          <div className=\"flex items-center gap-2 rounded-lg border border-border/50 bg-card/50 px-3 py-2 text-sm\">\n            <Loader2 className=\"h-4 w-4 animate-spin text-violet-400\" />\n            <span>Sending message...</span>\n          </div>\n        );\n      }\n      return (\n        <div className=\"flex items-center gap-2 rounded-lg border border-violet-500/30 bg-violet-500/10 px-3 py-2 text-sm text-violet-400\">\n          <MessageSquare className=\"h-4 w-4\" />\n          <span>\n            Message sent as <strong>{args.sender}</strong>\n          </span>\n        </div>\n      );\n    },\n    handler: ({ sender, content }) => {\n      setIsTyping(true);\n      setTimeout(() => {\n        addMessage(sender, content);\n        setIsTyping(false);\n      }, 600);\n      return `Message sent from ${sender}: \"${content}\"`;\n    },\n  });\n\n  // Action: Clear all messages\n  useCopilotAction({\n    name: \"clearHistory\",\n    description: \"Clear all chat messages and reset the conversation history\",\n    parameters: [],\n    render: ({ status }) => {\n      if (status === \"inProgress\") {\n        return (\n          <div className=\"flex items-center gap-2 rounded-lg border border-border/50 bg-card/50 px-3 py-2 text-sm\">\n            <Loader2 className=\"h-4 w-4 animate-spin text-red-400\" />\n            <span>Clearing history...</span>\n          </div>\n        );\n      }\n      return (\n        <div className=\"flex items-center gap-2 rounded-lg border border-red-500/30 bg-red-500/10 px-3 py-2 text-sm text-red-400\">\n          <Trash2 className=\"h-4 w-4\" />\n          <span>Chat history cleared</span>\n        </div>\n      );\n    },\n    handler: () => {\n      setMessages([]);\n      return \"Chat history has been cleared\";\n    },\n  });\n\n  // Action: Search messages and highlight matches\n  useCopilotAction({\n    name: \"searchMessages\",\n    description:\n      \"Search through chat messages for a keyword or phrase. Matching messages will be highlighted with a glow effect.\",\n    parameters: [\n      {\n        name: \"query\",\n        type: \"string\",\n        description: \"The search term to look for in message content\",\n        required: true,\n      },\n    ],\n    render: ({ status, args }) => {\n      if (status === \"inProgress\") {\n        return (\n          <div className=\"flex items-center gap-2 rounded-lg border border-border/50 bg-card/50 px-3 py-2 text-sm\">\n            <Loader2 className=\"h-4 w-4 animate-spin text-amber-400\" />\n            <span>\n              Searching for &quot;{args.query}&quot;...\n            </span>\n          </div>\n        );\n      }\n      const matchCount = messages.filter((m) => m.isHighlighted).length;\n      return (\n        <div className=\"flex items-center gap-2 rounded-lg border border-amber-500/30 bg-amber-500/10 px-3 py-2 text-sm text-amber-400\">\n          <Search className=\"h-4 w-4\" />\n          <span>\n            Found <strong>{matchCount}</strong> message(s) matching &quot;\n            {args.query}&quot;\n          </span>\n        </div>\n      );\n    },\n    handler: ({ query }) => {\n      const lowerQuery = query.toLowerCase();\n      let matchCount = 0;\n      setMessages((prev) =>\n        prev.map((msg) => {\n          const matches = msg.content.toLowerCase().includes(lowerQuery);\n          if (matches) matchCount++;\n          return { ...msg, isHighlighted: matches };\n        })\n      );\n      return `Found ${matchCount} message(s) matching \"${query}\"`;\n    },\n  });\n\n  // Action: Summarize the conversation\n  useCopilotAction({\n    name: \"summarizeConversation\",\n    description:\n      \"Generate a brief summary of the current conversation and add it as a system message in the chat\",\n    parameters: [\n      {\n        name: \"summary\",\n        type: \"string\",\n        description: \"A concise summary of the conversation so far\",\n        required: true,\n      },\n    ],\n    render: ({ status, args }) => {\n      if (status === \"inProgress\") {\n        return (\n          <div className=\"flex items-center gap-2 rounded-lg border border-border/50 bg-card/50 px-3 py-2 text-sm\">\n            <Loader2 className=\"h-4 w-4 animate-spin text-emerald-400\" />\n            <span>Summarizing conversation...</span>\n          </div>\n        );\n      }\n      return (\n        <div className=\"rounded-lg border border-emerald-500/30 bg-emerald-500/10 px-3 py-2 text-sm text-emerald-400\">\n          <div className=\"flex items-center gap-2 mb-1\">\n            <FileText className=\"h-4 w-4\" />\n            <strong>Conversation Summary</strong>\n          </div>\n          <p className=\"text-xs text-emerald-400/80\">{args.summary}</p>\n        </div>\n      );\n    },\n    handler: ({ summary }) => {\n      addMessage(\"System\", summary);\n      return `Summary added to chat: \"${summary}\"`;\n    },\n  });\n\n  return (\n    <div\n      className={cn(\n        \"flex flex-col rounded-xl border border-border/50 bg-card/50 backdrop-blur-sm\",\n        className\n      )}\n    >\n      {/* Header */}\n      <div className=\"flex items-center justify-between border-b border-border/30 px-4 py-3\">\n        <div className=\"flex items-center gap-2\">\n          <MessageSquare className=\"h-4 w-4 text-violet-400\" />\n          <h3 className=\"text-sm font-semibold text-foreground\">Chat</h3>\n          <span className=\"text-xs text-muted-foreground\">\n            {messages.length} messages\n          </span>\n        </div>\n      </div>\n\n      {/* Messages area */}\n      <div className=\"flex-1 overflow-y-auto px-4 py-3 space-y-3 min-h-[300px] max-h-[500px]\">\n        {messages.length === 0 && (\n          <div className=\"flex items-center justify-center h-full text-sm text-muted-foreground\">\n            No messages yet. Start the conversation!\n          </div>\n        )}\n\n        {messages.map((msg) => {\n          const isYou = msg.sender === \"You\";\n          const isSystem = msg.sender === \"System\";\n\n          if (isSystem) {\n            return (\n              <div key={msg.id} className=\"flex justify-center\">\n                <div\n                  className={cn(\n                    \"max-w-[85%] rounded-lg border border-border/30 bg-muted/30 px-3 py-2 text-center text-xs text-muted-foreground italic\",\n                    msg.isHighlighted &&\n                      \"border-amber-500/50 shadow-[0_0_12px_rgba(245,158,11,0.3)]\"\n                  )}\n                >\n                  <p>{msg.content}</p>\n                  <span className=\"mt-1 block text-[10px] text-muted-foreground/50\">\n                    {msg.timestamp}\n                  </span>\n                </div>\n              </div>\n            );\n          }\n\n          return (\n            <div\n              key={msg.id}\n              className={cn(\"flex\", isYou ? \"justify-end\" : \"justify-start\")}\n            >\n              <div\n                className={cn(\n                  \"max-w-[75%] rounded-2xl px-3.5 py-2.5 transition-all duration-300\",\n                  isYou\n                    ? \"bg-violet-600 text-white rounded-br-md\"\n                    : \"bg-muted/60 text-foreground rounded-bl-md border border-border/30\",\n                  msg.isHighlighted &&\n                    \"shadow-[0_0_16px_rgba(245,158,11,0.4)] ring-2 ring-amber-500/50\"\n                )}\n              >\n                {!isYou && (\n                  <span className=\"mb-0.5 block text-[11px] font-semibold text-muted-foreground\">\n                    {msg.sender}\n                  </span>\n                )}\n                <p className=\"text-sm leading-relaxed\">{msg.content}</p>\n                <span\n                  className={cn(\n                    \"mt-1 block text-right text-[10px]\",\n                    isYou\n                      ? \"text-white/60\"\n                      : \"text-muted-foreground/50\"\n                  )}\n                >\n                  {msg.timestamp}\n                </span>\n              </div>\n            </div>\n          );\n        })}\n\n        {/* Typing indicator */}\n        {isTyping && (\n          <div className=\"flex justify-start\">\n            <div className=\"flex items-center gap-1.5 rounded-2xl rounded-bl-md bg-muted/60 border border-border/30 px-4 py-3\">\n              <span className=\"h-2 w-2 rounded-full bg-muted-foreground/60 animate-bounce [animation-delay:0ms]\" />\n              <span className=\"h-2 w-2 rounded-full bg-muted-foreground/60 animate-bounce [animation-delay:150ms]\" />\n              <span className=\"h-2 w-2 rounded-full bg-muted-foreground/60 animate-bounce [animation-delay:300ms]\" />\n            </div>\n          </div>\n        )}\n\n        <div ref={messagesEndRef} />\n      </div>\n\n      {/* Input area */}\n      <div className=\"border-t border-border/30 px-4 py-3\">\n        <div className=\"flex items-center gap-2\">\n          <Input\n            value={inputValue}\n            onChange={(e) => setInputValue(e.target.value)}\n            onKeyDown={handleKeyDown}\n            placeholder=\"Type a message...\"\n            className=\"flex-1\"\n          />\n          <Button\n            onClick={handleSend}\n            disabled={!inputValue.trim()}\n            size=\"icon\"\n            className=\"shrink-0 bg-violet-600 hover:bg-violet-700 text-white disabled:opacity-40\"\n          >\n            <Send className=\"h-4 w-4\" />\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n",
      "type": "registry:component"
    }
  ]
}