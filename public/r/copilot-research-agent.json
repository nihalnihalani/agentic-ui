{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "copilot-research-agent",
  "type": "registry:component",
  "title": "ResearchAgent",
  "description": "Multi-step AI research agent with pipeline progress, findings, and synthesis.",
  "dependencies": [
    "@copilotkit/react-core",
    "lucide-react"
  ],
  "registryDependencies": [],
  "docs": "## Setup\n\n### 1. Install CopilotKit dependencies\n\n```bash\nnpm install @copilotkit/react-core @copilotkit/react-ui @copilotkit/runtime\n```\n\n### 2. Create an API route\n\nCreate `app/api/copilotkit/route.ts`:\n\n```ts\nimport {\n  CopilotRuntime,\n  OpenAIAdapter,\n  copilotRuntimeNextJSAppRouterEndpoint,\n} from \"@copilotkit/runtime\";\n\nexport const maxDuration = 60;\n\nconst runtime = new CopilotRuntime();\nconst serviceAdapter = new OpenAIAdapter();\n\nconst { handleRequest } = copilotRuntimeNextJSAppRouterEndpoint({\n  runtime,\n  serviceAdapter,\n  endpoint: \"/api/copilotkit\",\n});\n\nexport { handleRequest as POST };\n```\n\n### 3. Environment variables\n\nAdd to `.env.local`:\n\n```\nOPENAI_API_KEY=sk-...\n```\n\n### 4. Wrap your app with CopilotKit\n\nIn your page or layout, wrap the component tree with the CopilotKit provider and add a chat UI:\n\n```tsx\n\"use client\";\nimport { CopilotKit } from \"@copilotkit/react-core\";\nimport { CopilotPopup } from \"@copilotkit/react-ui\";\nimport \"@copilotkit/react-ui/styles.css\";\n\nexport default function Page() {\n  return (\n    <CopilotKit runtimeUrl=\"/api/copilotkit\">\n      {/* your components here */}\n      <CopilotPopup />\n    </CopilotKit>\n  );\n}\n```\n\n## Usage\n\n```tsx\nimport { CopilotResearchAgent } from \"@/components/copilot-research-agent\";\n\n<CopilotResearchAgent />\n```\n\nOr with a pre-set topic:\n\n```tsx\n<CopilotResearchAgent initialState={{ topic: \"AI in healthcare\" }} />\n```\n\nAsk the AI to start research, add findings, or synthesize results.",
  "files": [
    {
      "path": "registry/copilot-research-agent.tsx",
      "content": "\"use client\";\n\nimport { useState, useCallback, useRef } from \"react\";\nimport { useCopilotReadable, useCopilotAction } from \"@copilotkit/react-core\";\nimport { cn } from \"@/lib/utils\";\nimport {\n  Search,\n  FileText,\n  Brain,\n  CheckCircle,\n  Loader2,\n  Sparkles,\n  ExternalLink,\n} from \"lucide-react\";\n\nexport interface ResearchFinding {\n  id: string;\n  title: string;\n  summary: string;\n  source: string;\n  relevance: \"high\" | \"medium\" | \"low\";\n}\n\nexport interface ResearchState {\n  topic: string;\n  status: \"idle\" | \"searching\" | \"analyzing\" | \"synthesizing\" | \"complete\";\n  depth: \"quick\" | \"standard\" | \"deep\";\n  findings: ResearchFinding[];\n  synthesis: string | null;\n}\n\ninterface CopilotResearchAgentProps {\n  initialState?: Partial<ResearchState>;\n  className?: string;\n}\n\nconst PIPELINE_STEPS = [\n  { key: \"searching\", label: \"Searching Sources\", icon: Search },\n  { key: \"analyzing\", label: \"Analyzing Data\", icon: FileText },\n  { key: \"synthesizing\", label: \"Synthesizing Results\", icon: Brain },\n  { key: \"complete\", label: \"Research Complete\", icon: CheckCircle },\n] as const;\n\nconst relevanceColors: Record<string, string> = {\n  high: \"bg-emerald-500/20 text-emerald-400 border-emerald-500/30\",\n  medium: \"bg-amber-500/20 text-amber-400 border-amber-500/30\",\n  low: \"bg-blue-500/20 text-blue-400 border-blue-500/30\",\n};\n\nconst defaultFindings: ResearchFinding[] = [\n  {\n    id: \"f1\",\n    title: \"LLM-Powered UI Components\",\n    summary:\n      \"Recent advances in large language models have enabled a new class of UI components that can understand user intent and manipulate interface state through natural language, reducing the gap between user goals and interface actions.\",\n    source: \"AI Research Review, 2025\",\n    relevance: \"high\",\n  },\n  {\n    id: \"f2\",\n    title: \"Agentic Design Patterns\",\n    summary:\n      \"The agentic UI pattern involves exposing component state via readable hooks and defining actions the AI can invoke. This bidirectional communication allows AI to both understand and modify the interface.\",\n    source: \"Frontend Architecture Journal\",\n    relevance: \"high\",\n  },\n  {\n    id: \"f3\",\n    title: \"User Trust in AI-Driven Interfaces\",\n    summary:\n      \"Studies show that inline progress feedback (spinners, confirmation badges) during AI actions significantly increases user trust and perceived reliability of AI-powered interfaces.\",\n    source: \"HCI Conference Proceedings\",\n    relevance: \"medium\",\n  },\n  {\n    id: \"f4\",\n    title: \"Render Callbacks for Chat Integration\",\n    summary:\n      \"Using render callbacks in copilot actions enables rich, contextual feedback within chat interfaces, creating a more integrated experience than simple text responses.\",\n    source: \"CopilotKit Documentation\",\n    relevance: \"medium\",\n  },\n  {\n    id: \"f5\",\n    title: \"Component Registry Architecture\",\n    summary:\n      \"A registry-based approach to distributing AI-enhanced components allows developers to install individual components via CLI, similar to the shadcn/ui pattern, promoting modularity.\",\n    source: \"Open Source Weekly\",\n    relevance: \"low\",\n  },\n];\n\nconst defaultSynthesis =\n  \"AI-powered UI components represent a significant shift in frontend development. By combining readable state hooks with action-based AI integration, developers can create interfaces that understand and respond to natural language. Key success factors include inline progress feedback for user trust, render callbacks for rich chat integration, and a modular registry architecture for distribution.\";\n\nconst defaultState: ResearchState = {\n  topic: \"AI-Powered UI Components\",\n  status: \"complete\",\n  depth: \"standard\",\n  findings: defaultFindings,\n  synthesis: defaultSynthesis,\n};\n\nfunction getStepIndex(status: ResearchState[\"status\"]): number {\n  const map: Record<string, number> = {\n    idle: -1,\n    searching: 0,\n    analyzing: 1,\n    synthesizing: 2,\n    complete: 3,\n  };\n  return map[status] ?? -1;\n}\n\nexport function CopilotResearchAgent({\n  initialState,\n  className,\n}: CopilotResearchAgentProps) {\n  const [research, setResearch] = useState<ResearchState>({\n    ...defaultState,\n    ...initialState,\n  });\n  const [highlightedIds, setHighlightedIds] = useState<Set<string>>(new Set());\n  const highlightTimeouts = useRef<Map<string, ReturnType<typeof setTimeout>>>(\n    new Map()\n  );\n\n  const triggerHighlight = useCallback((id: string) => {\n    const existing = highlightTimeouts.current.get(id);\n    if (existing) clearTimeout(existing);\n\n    setHighlightedIds((prev) => new Set(prev).add(id));\n    const timeout = setTimeout(() => {\n      setHighlightedIds((prev) => {\n        const next = new Set(prev);\n        next.delete(id);\n        return next;\n      });\n      highlightTimeouts.current.delete(id);\n    }, 1500);\n    highlightTimeouts.current.set(id, timeout);\n  }, []);\n\n  // Expose research state to AI\n  useCopilotReadable({\n    description:\n      \"Current research agent state including topic, status, depth, findings, and synthesis\",\n    value: {\n      topic: research.topic,\n      status: research.status,\n      depth: research.depth,\n      findingsCount: research.findings.length,\n      findings: research.findings.map((f) => ({\n        id: f.id,\n        title: f.title,\n        relevance: f.relevance,\n        source: f.source,\n      })),\n      synthesis: research.synthesis,\n    },\n  });\n\n  // Action: Conduct research (simulated multi-step process)\n  useCopilotAction({\n    name: \"conductResearch\",\n    description:\n      \"Conduct a multi-step research process on a given topic. Simulates searching, analyzing, and synthesizing findings. Provide the topic and depth (quick, standard, or deep).\",\n    parameters: [\n      {\n        name: \"topic\",\n        type: \"string\",\n        description: \"The research topic to investigate\",\n        required: true,\n      },\n      {\n        name: \"depth\",\n        type: \"string\",\n        description:\n          'Research depth: \"quick\" (3 findings), \"standard\" (5 findings), or \"deep\" (8 findings)',\n      },\n      {\n        name: \"findings\",\n        type: \"string\",\n        description:\n          \"JSON array of findings. Each finding: {title, summary, source, relevance}. Generate findings relevant to the topic.\",\n        required: true,\n      },\n      {\n        name: \"synthesis\",\n        type: \"string\",\n        description:\n          \"A synthesized summary paragraph combining all findings into a cohesive conclusion.\",\n        required: true,\n      },\n    ],\n    render: ({ status }) => {\n      if (status === \"inProgress\") {\n        return (\n          <div className=\"flex items-center gap-2 rounded-lg border border-border/50 bg-card/50 px-3 py-2 text-sm\">\n            <Loader2 className=\"h-4 w-4 animate-spin text-violet-400\" />\n            <span>Conducting research...</span>\n          </div>\n        );\n      }\n      return (\n        <div className=\"rounded-lg border border-violet-500/30 bg-violet-500/10 px-3 py-2 text-sm text-violet-400\">\n          <div className=\"flex items-center gap-2\">\n            <CheckCircle className=\"h-4 w-4\" />\n            <span>Research complete</span>\n          </div>\n        </div>\n      );\n    },\n    handler: async ({ topic, depth, findings: findingsJson, synthesis }) => {\n      const researchDepth = (depth as ResearchState[\"depth\"]) || \"standard\";\n\n      // Step 1: Searching\n      setResearch((prev) => ({\n        ...prev,\n        topic,\n        depth: researchDepth,\n        status: \"searching\",\n        findings: [],\n        synthesis: null,\n      }));\n      await new Promise((r) => setTimeout(r, 800));\n\n      // Step 2: Analyzing\n      setResearch((prev) => ({ ...prev, status: \"analyzing\" }));\n      await new Promise((r) => setTimeout(r, 800));\n\n      // Step 3: Synthesizing\n      let parsedFindings: ResearchFinding[];\n      try {\n        const raw = JSON.parse(findingsJson);\n        parsedFindings = raw.map(\n          (\n            f: { title: string; summary: string; source: string; relevance: string },\n            i: number\n          ) => ({\n            id: `f-${Date.now()}-${i}`,\n            title: f.title,\n            summary: f.summary,\n            source: f.source,\n            relevance: f.relevance || \"medium\",\n          })\n        );\n      } catch {\n        parsedFindings = defaultFindings;\n      }\n\n      setResearch((prev) => ({\n        ...prev,\n        status: \"synthesizing\",\n        findings: parsedFindings,\n      }));\n      await new Promise((r) => setTimeout(r, 600));\n\n      // Step 4: Complete\n      setResearch((prev) => ({\n        ...prev,\n        status: \"complete\",\n        synthesis: synthesis || defaultSynthesis,\n      }));\n\n      parsedFindings.forEach((f) => triggerHighlight(f.id));\n\n      return `Research on \"${topic}\" complete with ${parsedFindings.length} findings.`;\n    },\n  });\n\n  // Action: Highlight a finding\n  useCopilotAction({\n    name: \"highlightFinding\",\n    description: \"Highlight a specific research finding to draw attention to it\",\n    parameters: [\n      {\n        name: \"findingId\",\n        type: \"string\",\n        description: `The ID of the finding to highlight. Available: ${research.findings.map((f) => f.id).join(\", \")}`,\n        required: true,\n      },\n    ],\n    render: ({ status, args }) => {\n      if (status === \"inProgress\") {\n        return (\n          <div className=\"flex items-center gap-2 rounded-lg border border-border/50 bg-card/50 px-3 py-2 text-sm\">\n            <Loader2 className=\"h-4 w-4 animate-spin text-amber-400\" />\n            <span>Highlighting finding...</span>\n          </div>\n        );\n      }\n      const finding = research.findings.find((f) => f.id === args.findingId);\n      return (\n        <div className=\"flex items-center gap-2 rounded-lg border border-amber-500/30 bg-amber-500/10 px-3 py-2 text-sm text-amber-400\">\n          <Sparkles className=\"h-4 w-4\" />\n          <span>\n            Highlighted <strong>{finding?.title ?? args.findingId}</strong>\n          </span>\n        </div>\n      );\n    },\n    handler: ({ findingId }) => {\n      const finding = research.findings.find((f) => f.id === findingId);\n      if (!finding) return `Finding \"${findingId}\" not found`;\n      triggerHighlight(findingId);\n      return `Highlighted finding: ${finding.title}`;\n    },\n  });\n\n  // Action: Clear research\n  useCopilotAction({\n    name: \"clearResearch\",\n    description: \"Reset the research agent to idle state, clearing all findings\",\n    parameters: [],\n    handler: () => {\n      setResearch({\n        topic: \"\",\n        status: \"idle\",\n        depth: \"standard\",\n        findings: [],\n        synthesis: null,\n      });\n      return \"Research cleared\";\n    },\n  });\n\n  const currentStepIndex = getStepIndex(research.status);\n\n  return (\n    <div className={cn(\"w-full space-y-6\", className)}>\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-lg font-semibold text-foreground\">\n            Research Agent\n          </h2>\n          {research.topic && (\n            <p className=\"text-sm text-muted-foreground\">\n              Topic: <span className=\"text-foreground\">{research.topic}</span>\n              {research.depth !== \"standard\" && (\n                <span className=\"ml-2 rounded-full border border-border/50 px-2 py-0.5 text-xs\">\n                  {research.depth}\n                </span>\n              )}\n            </p>\n          )}\n        </div>\n        {research.status !== \"idle\" && research.status !== \"complete\" && (\n          <div className=\"flex items-center gap-2 text-sm text-violet-400\">\n            <Loader2 className=\"h-4 w-4 animate-spin\" />\n            <span className=\"capitalize\">{research.status}...</span>\n          </div>\n        )}\n      </div>\n\n      {/* Research Pipeline */}\n      <div className=\"rounded-xl border border-border/50 bg-card/50 p-4\">\n        <h3 className=\"mb-3 text-xs font-medium uppercase tracking-wider text-muted-foreground\">\n          Research Pipeline\n        </h3>\n        <div className=\"flex items-center gap-2\">\n          {PIPELINE_STEPS.map((step, i) => {\n            const isActive = currentStepIndex === i;\n            const isComplete = currentStepIndex > i;\n            const isPending = currentStepIndex < i;\n            const Icon = step.icon;\n\n            return (\n              <div key={step.key} className=\"flex flex-1 items-center gap-2\">\n                <div\n                  className={cn(\n                    \"flex items-center gap-2 rounded-lg border px-3 py-2 text-xs font-medium transition-all flex-1\",\n                    isActive &&\n                      \"border-violet-500/50 bg-violet-500/10 text-violet-400\",\n                    isComplete &&\n                      \"border-emerald-500/50 bg-emerald-500/10 text-emerald-400\",\n                    isPending &&\n                      \"border-border/30 bg-muted/20 text-muted-foreground/50\"\n                  )}\n                >\n                  <Icon\n                    className={cn(\n                      \"h-3.5 w-3.5 shrink-0\",\n                      isActive && \"animate-pulse\"\n                    )}\n                  />\n                  <span className=\"hidden sm:inline\">{step.label}</span>\n                </div>\n                {i < PIPELINE_STEPS.length - 1 && (\n                  <div\n                    className={cn(\n                      \"h-px w-4 shrink-0\",\n                      isComplete ? \"bg-emerald-500/50\" : \"bg-border/30\"\n                    )}\n                  />\n                )}\n              </div>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* Findings */}\n      {research.findings.length > 0 && (\n        <div className=\"space-y-3\">\n          <h3 className=\"text-sm font-semibold text-foreground\">\n            Findings ({research.findings.length})\n          </h3>\n          <div className=\"grid gap-3 sm:grid-cols-2\">\n            {research.findings.map((finding) => {\n              const isHighlighted = highlightedIds.has(finding.id);\n              return (\n                <div\n                  key={finding.id}\n                  className={cn(\n                    \"rounded-lg border border-border/50 bg-card/50 p-4 transition-all duration-300\",\n                    isHighlighted &&\n                      \"border-violet-500/60 shadow-[0_0_16px_rgba(139,92,246,0.25)]\"\n                  )}\n                >\n                  <div className=\"flex items-start justify-between gap-2\">\n                    <h4 className=\"text-sm font-medium text-foreground\">\n                      {finding.title}\n                    </h4>\n                    <span\n                      className={cn(\n                        \"shrink-0 rounded-full border px-2 py-0.5 text-[10px] font-medium capitalize\",\n                        relevanceColors[finding.relevance]\n                      )}\n                    >\n                      {finding.relevance}\n                    </span>\n                  </div>\n                  <p className=\"mt-2 text-xs leading-relaxed text-muted-foreground\">\n                    {finding.summary}\n                  </p>\n                  <div className=\"mt-3 flex items-center gap-1.5 text-xs text-muted-foreground/60\">\n                    <ExternalLink className=\"h-3 w-3\" />\n                    {finding.source}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      )}\n\n      {/* Synthesis */}\n      {research.synthesis && (\n        <div className=\"rounded-xl border border-violet-500/30 bg-violet-500/5 p-4\">\n          <div className=\"flex items-start gap-3\">\n            <div className=\"flex size-8 shrink-0 items-center justify-center rounded-lg bg-violet-500/10\">\n              <Sparkles className=\"h-4 w-4 text-violet-400\" />\n            </div>\n            <div>\n              <p className=\"text-sm font-medium text-foreground\">\n                AI Synthesis\n              </p>\n              <p className=\"mt-1 text-sm leading-relaxed text-muted-foreground\">\n                {research.synthesis}\n              </p>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Empty state */}\n      {research.status === \"idle\" && research.findings.length === 0 && (\n        <div className=\"flex flex-col items-center justify-center rounded-lg border border-dashed border-border/40 py-12 text-muted-foreground\">\n          <Search className=\"mb-3 h-8 w-8 text-muted-foreground/40\" />\n          <p className=\"text-sm font-medium\">No research conducted yet</p>\n          <p className=\"text-xs text-muted-foreground/60\">\n            Ask the AI to research a topic to get started.\n          </p>\n        </div>\n      )}\n\n      {/* Screen reader live region */}\n      <div aria-live=\"polite\" className=\"sr-only\">\n        Research agent: {research.status} on topic &quot;{research.topic}&quot;\n        with {research.findings.length} findings\n      </div>\n    </div>\n  );\n}\n",
      "type": "registry:component"
    }
  ]
}